<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Retrieval Theory</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/Favicon-1.png" rel="icon">
  <link href="assets/img/Favicon-1.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
    <!-- Creating a python code section-->
    <link rel="stylesheet" href="assets/css/prism.css">
    <script src="assets/js/prism.js"></script>

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

    <!-- To set the icon, visit https://fontawesome.com/account-->
    <script src="https://kit.fontawesome.com/5d25c1efd3.js" crossorigin="anonymous"></script>
    <!-- end of icon-->

    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

  <!-- =======================================================
  * Template Name: iPortfolio
  * Updated: Sep 18 2023 with Bootstrap v5.3.2
  * Template URL: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Mobile nav toggle button ======= -->
  <i class="bi bi-list mobile-nav-toggle d-xl-none"></i>

  <!-- ======= Header ======= -->
  <header id="header">
    <div class="d-flex flex-column">

      <div class="profile">
        <img src="assets/img/myphoto.jpeg" alt="" class="img-fluid rounded-circle">
        <h1 class="text-light"><a href="index.html">Arun</a></h1>
        <div class="social-links mt-3 text-center">
          <a href="https://www.linkedin.com/in/arunp77/" target="_blank" class="linkedin"><i class="bx bxl-linkedin"></i></a>
          <a href="https://github.com/arunp77" target="_blank" class="github"><i class="bx bxl-github"></i></a>
          <a href="https://twitter.com/arunp77_" target="_blank" class="twitter"><i class="bx bxl-twitter"></i></a>
          <a href="https://www.instagram.com/arunp77/" target="_blank" class="instagram"><i class="bx bxl-instagram"></i></a>
          <a href="https://arunp77.medium.com/" target="_blank" class="medium"><i class="bx bxl-medium"></i></a>
        </div>
      </div>

      <nav id="navbar" class="nav-menu navbar">
        <ul>
          <li><a href="index.html#hero" class="nav-link scrollto active"><i class="bx bx-home"></i> <span>Home</span></a></li>
          <li><a href="index.html#about" class="nav-link scrollto"><i class="bx bx-user"></i> <span>About</span></a></li>
          <li><a href="index.html#resume" class="nav-link scrollto"><i class="bx bx-file-blank"></i> <span>Resume</span></a></li>
          <li><a href="index.html#portfolio" class="nav-link scrollto"><i class="bx bx-book-content"></i> <span>Portfolio</span></a></li>
          <li><a href="index.html#skills-and-tools" class="nav-link scrollto"><i class="bx bx-wrench"></i> <span>Skills and Tools</span></a></li>
          <li><a href="index.html#language" class="nav-link scrollto"><i class="bi bi-menu-up"></i> <span>Languages</span></a></li>
          <li><a href="index.html#awards" class="nav-link scrollto"><i class="bi bi-award-fill"></i> <span>Awards</span></a></li>
          <li><a href="index.html#professionalcourses" class="nav-link scrollto"><i class="bx bx-book-alt"></i> <span>Professional Certification</span></a></li>
          <li><a href="index.html#publications" class="nav-link scrollto"><i class="bx bx-news"></i> <span>Publications</span></a></li>
          <li><a href="index.html#extra-curricular" class="nav-link scrollto"><i class="bx bx-rocket"></i> <span>Extra-Curricular Activities</span></a></li>
          <!-- <li><a href="#contact" class="nav-link scrollto"><i class="bx bx-envelope"></i> <span>Contact</span></a></li> -->
        </ul>
      </nav><!-- .nav-menu -->
    </div>
  </header><!-- End Header -->

<main id="main">

    <!-- ======= Breadcrumbs ======= -->
    <section id="breadcrumbs" class="breadcrumbs">
      <div class="container">

        <div class="d-flex justify-content-between align-items-center">
          <h2>Inverse Problem & Retrieval Theory</h2>
          <ol>
            <li><a href="project_co2_measurment.html" class="clickable-box"><i class="fas fa-arrow-left"></i> Content</a></li>
            <li><a href="Remote-sensing-content.html" class="clickable-box">Home</a></li>
          </ol>
        </div>

      </div>
    </section><!-- End Breadcrumbs -->

    <!------  right dropdown menue ------->
    <div class="right-side-list">
      <div class="dropdown">
          <button class="dropbtn"><strong>Shortcuts:</strong></button>
          <div class="dropdown-content">
              <ul>
                  <li><a href="cloud-compute.html"><i class="fas fa-cloud"></i> Cloud</a></li>
                  <li><a href="AWS-GCP.html"><i class="fas fa-cloud"></i> AWS-GCP</a></li>
                  <li><a href="amazon-s3.html"><i class="fas fa-cloud"></i> AWS S3</a></li>
                  <li><a href="ec2-confi.html"><i class="fas fa-server"></i> EC2</a></li>
                  <li><a href="Docker-Container.html"><i class="fab fa-docker" style="color: rgb(7, 7, 7);"></i> Docker</a></li>
                  <li><a href="Jupyter-nifi.html"><i class="fab fa-python" style="color: rgb(8, 8, 8);"></i> Jupyter-nifi</a></li>
                  <li><a href="snowflake-task-stream.html"><i class="fas fa-snowflake"></i> Snowflake</a></li>
                  <li><a href="data-model.html"><i class="fas fa-database"></i> Data modeling</a></li>
                  <li><a href="sql-basics.html"><i class="fas fa-table"></i> QL</a></li>
                  <li><a href="sql-basic-details.html"><i class="fas fa-database"></i> SQL</a></li>
                  <li><a href="Bigquerry-sql.html"><i class="fas fa-database"></i> Bigquerry</a></li>
                  <li><a href="scd.html"><i class="fas fa-archive"></i> SCD</a></li>
                  <li><a href="sql-project.html"><i class="fas fa-database"></i> SQL project</a></li>
                    <!-- Add more subsections as needed -->
                </ul>
          </div>
        </div>
    </div>

    <!-- ======= Portfolio Details Section ======= -->
    <section id="portfolio-details" class="portfolio-details">
        <div class="container">
            <div class="row gy-4">
                <h1>Inverse Problem & Retrieval Theory</h1>
                <!-- <div class="w-100">
                    <img src="assets/img/remote-sensing/Active-passive.png"
                        alt="Active Passive"
                        style="width: 100vw; height: auto; display: block;">
                </div> -->
                    

                <section>
                    <h3>Introduction and Objective</h3>

                    <p>The goal of this section is to formally describe how atmospheric CO₂ is retrieved from measured satellite spectra using inverse theory.</p>

                    In <a href="co2_1.html" target="_blank">Part I: Fundamental Radiometric Quantities</a>, we derived the forward radiative transfer model:

                    $$
                    I_\nu = I_{\nu,0} \exp(-\tau_\nu)
                    $$

                    <p>This equation describes how atmospheric properties determine the measured radiance. However, satellite retrieval operates in the opposite direction:</p>

                    <p>We measure radiance \( I_\nu \) and seek to determine the atmospheric state that produced it.</p>

                    <p>This constitutes an inverse problem.</p>

                    <p><b>So fundamental retrival question is</b>
                        how from a given vector of measured radiance \(y\) and a radiative trasfer model \(F\), 
                        we calculate atmospheric state vecotr \(x\), such that 

                        $$y = F(x)$$
                    </p>

                    <p>For CO₂ missions like MicroCarb, the primary quantity of interest is: </p>

                    $$
                    \text{XCO}_2 = \frac{\int n_{\text{CO}_2}(z), dz}{\int n_{\text{dry}\ \text{air}}(z), dz}
                    $$

                    This is the column-averaged dry air mole fraction of CO₂. The inversion is not trivial because:

                    <ul>
                        <li>The forward model \( F(x) \) is nonlinear.</li>
                        <li>Measurements contain noise.</li>
                        <li>Multiple atmospheric parameters influence the spectrum simultaneously.</li>
                        <li>Different parameters may produce similar spectral effects (degeneracy).</li>
                        <li>The problem can be ill-conditioned.</li>
                    </ul>
                    
                    Thus, direct inversion is unstable.

                    <p><b>Retrieval as a Statistical Estimation Problem: </b>Because measurements contain uncertainty, the solution must be formulated probabilistically. 
                    Instead of solving:
                    </p>

                    $$
                    y = F(x)
                    $$

                    we solve:

                    $$
                    y = F(x) + \epsilon
                    $$

                    where \( \epsilon \) represents measurement error. The goal becomes:

                    <pre><code>Estimate the most probable atmospheric state consistent with the measurements and prior knowledge.</code></pre>

                    This leads naturally to a Bayesian framework and the Optimal Estimation method.

                    <p><b>What This Section Will Establish?</b></p>

                    This section will:
                    <ul>
                        <li>Formulate the forward model in vector form</li>
                        <li>Define the state vector and measurement vector</li>
                        <li>Linearize the forward model</li>
                        <li>Derive the Optimal Estimation retrieval equation</li>
                        <li>Define the gain matrix</li>
                        <li>Derive the averaging kernel</li>
                        <li>Derive posterior error covariance</li>
                        <li>Decompose retrieval error into noise and smoothing components</li>
                    </ul>


                    By the end of this section, we will have a complete mathematical description of how CO₂ is retrieved from measured spectra and 
                    how the information content of the retrieval can be quantified.
                    
                    <!-- Section started  -->
                    <h3>Forward Model Formulation</h3>
                    <p>The forward model describes how the atmospheric state determines the radiance measured by the satellite instrument. In retrieval problems, we define 
                        
                        $$y = F(x)$$ 
                        where
                        <ul>
                            <li>\(x =\) atmospheric state vector,</li>
                            <li>\(y=\) measurement vector (radiances),</li>
                            <li>\(F=\)radiative transfer operator.</li>
                        </ul> 
                    </p>
                    <p>The forward model must include:</p>
                    <ul>
                        <li>Radiative transfer physics</li>
                        <li>Atmospheric composition</li>
                        <li>Scattering processes</li>
                        <li>Surface reflection</li>
                        <li>Instrument effects</li>
                    </ul>

                    <!-- subsection -->
                    <h5>Measurement Geometry</h5>
                    For reflected solar missions (SWIR CO₂ retrieval), radiance measured at the sensor depends on Solar zenith angle \(\theta_s\), 
                    \(\theta_v\), Relative azimuth angle \(\phi\). Therefore radiance is a function of:

                    $$I_\nu = I_\nu(\theta_s, \theta_v, \phi)$$

                    Photon path consists of: 
                    <ul>
                        <li>Sun → atmosphere (downward path)</li>
                        <li>Surface reflection</li>
                        <li>Atmosphere (upward path) → satellite</li>
                    </ul>
                    Thus total optical depth is two-way.

                    <!-- subsection -->
                    <h5>Monochromatic Radiance Expression</h5>
                    Ignoring polarization for now, the radiance at top of atmosphere (TOA) can be written as:

                    $$
                    I_\nu^{\rm TOA} = \frac{\mu_s}{\pi} E_\nu^{\rm sun}T_\nu^{\rm down}R_\nu^{\rm surf}T_\nu^{\rm up} + I_\nu^{\rm path} 
                    $$

                    where:
                    <ul>
                        <li>\( \mu_s = \cos\theta_s \)</li>
                        <li>\( E_\nu^{sun} \) = solar irradiance</li>
                        <li>\( T_\nu^{down} \) = transmission along downward path</li>
                        <li>\( T_\nu^{up} \) = transmission along upward path</li>
                        <li>\( R_\nu^{surf} \) = surface reflectance</li>
                        <li>\( I_\nu^{path} \) = atmospheric path radiance (scattering contribution)</li>
                    </ul>

                    <!-- subsection -->
                    <h5>Transmission Terms</h5>
                    Transmission is exponential of optical depth:

                    $$
                    T_\nu^{down} = \exp(-\tau_\nu^{down})
                    $$

                    $$
                    T_\nu^{up} = \exp(-\tau_\nu^{up})
                    $$

                    For slant geometry:

                    $$
                    \tau_\nu^{down} =
                    \frac{1}{\mu_s}
                    \int_0^\infty
                    \beta_\nu(z) dz
                    $$

                    $$
                    \tau_\nu^{up} =
                    \frac{1}{\mu_v}
                    \int_0^\infty
                    \beta_\nu(z) dz
                    $$

                    Thus total transmission:

                    $$
                    T_\nu = \exp\left(-\left(\frac{1}{\mu_s} + \frac{1}{\mu_v}\right) \int_0^\infty \beta_\nu(z) dz\right)
                    $$

                    <!-- Subsection -->

                    <h5>Optical Depth Components</h5>
                    Extinction coefficient:

                    $$
                    \beta_\nu(z) = \sum_g n_g(z) \sigma_{\nu,g}(T,p) + \beta_\nu^{aer}(z) + \beta_\nu^{cloud}(z)
                    $$

                    So optical depth becomes:

                    $$
                    \tau_\nu =
                    \tau_\nu^{gas}
                    +
                    \tau_\nu^{aer}
                    +
                    \tau_\nu^{cloud}
                    $$

                    Gas optical depth:

                    $$
                    \tau_\nu^{gas} = \sum_g \int_0^\infty n_g(z) \sigma_{\nu,g}(T,p) dz
                    $$

                    For CO₂ retrieval, we isolate the CO₂ term:

                    $$
                    \tau_\nu^{CO_2} = \int_0^\infty n_{CO_2}(z) \sigma_\nu^{CO_2}(T,p) dz
                    $$

                    <!-- subsection -->
                    <h5>Surface Reflectance Model</h5>
                    Surface reflectance may be modeled as:

                    Lambertian:

                    $$
                    R_\nu^{surf} = A_\nu
                    $$

                    Or BRDF model:

                    $$
                    R_\nu^{surf} =
                    f(\theta_s, \theta_v, \phi)
                    $$

                    This becomes part of state vector.

                    <h5>Full Forward Model Expression</h5>

                    Putting all terms together:

                    $$
                    I_\nu^{TOA} = \frac{\mu_s}{\pi} E_\nu^{sun} A_\nu \exp(-\tau_\nu^{down} - \tau_\nu^{up}) + I_\nu^{path} 
                    $$

                    In simplified pure absorption case (neglecting path radiance):

                    $$
                    I_\nu^{TOA} =  C_\nu \exp(-\tau_\nu^{total})
                    $$

                    Where:

                    $$
                    C_\nu = \frac{\mu_s}{\pi} E_\nu^{sun} A_\nu
                    $$

                    This is often sufficient for conceptual retrieval explanation.

                    <!-- section -->

                    <h3>Vector Form of Forward Model</h3>

                    Discretize wavelengths:

                    $$
                    y =
                    \begin{bmatrix}
                    I_{\nu_1} \\
                    I_{\nu_2} \\
                    \vdots \\
                    I_{\nu_m}
                    \end{bmatrix}
                    $$

                    State vector:

                    $$
                    x =
                    \begin{bmatrix}
                    \text{XCO}_2 \\
                    \text{Aerosol parameters} \\
                    \text{Surface albedo} \\
                    \text{Temperature scaling} \\
                    \text{Wavelength shift}
                    \end{bmatrix}
                    $$

                    Define nonlinear operator:

                    $$
                    F(x) =
                    \begin{bmatrix}
                    F_{\nu_1}(x) \
                    F_{\nu_2}(x) \
                    \vdots \
                    F_{\nu_m}(x)
                    \end{bmatrix}
                    $$

                    Thus:

                    $$
                    y = F(x)
                    $$

                    <h5>Instrument Effects</h5>

                    Real measurement is convolution with instrument line shape (ILS):

                    $$
                    I_\nu^{meas} = \int I_{\nu'}^{true} G(\nu - \nu') d\nu'
                    $$

                    Where \( G \) = instrument spectral response. Thus forward model includes convolution step.


                    <h3>Final Forward Model Definition</h3>
                    Complete forward operator:

                    $$
                    y = \mathcal{C}
                    \left(
                    \mathcal{R}(x)
                    \right)
                    $$

                    Where:

                    <ul>
                        <li>\( \mathcal{R} \) = radiative transfer operator</li>
                        <li>\( \mathcal{C} \) = convolution with instrument response</li>
                    </ul>

                    Expanded:

                    $$
                    y = \text{ILS} \Big[\frac{\mu_s}{\pi}E_\nu^{\rm sun} A_\nu \exp\left(\tau_\nu^{{\rm CO}_2} \tau_\nu^{\rm aer} \tau_\nu^{\rm cloud}\right) \Big]
                    $$

                    This is the fully defined forward model.













                    <br>
                    <h3>Reference</h3>

                    <ul>
                        <li><a href="https://arunp77.github.io/Remote-sensing.html" target="_blank">Fundamentals of Remote sensing</a></li>
                        <li><a href="https://arunp77.github.io/electromagnetic-waves.html" target="_blank">Relevance of Electromagnetic waves in the context of earth observation</a></li>
                        <li><a href="https://arunp77.github.io/Remote-sensing-content.html" target="_blank">Concept of the orbits for a satellite (non scientific discussion)</a></li>
                        <li><a href="https://arunp77.github.io/Ground-segment-systems.html" target="_blank">How various teams works in close collaboration for the ground data processing?</a></li>
                        <li><a href="https://arunp77.github.io/Satellite-data.html" target="_blank">How raw satellite data is processed to do a level where you do your scientifc research?</a></li>
                        <li><a href="https://arunp77.github.io/toa-reflectance.html" target="_blank">In depth understandingof the satellite data (op-of-atmosphere reflectance)</a></li>
                        <li><a href="https://arunp77.github.io/Satellites-sensors.html" target="_blank">Resolution and calibration</a></li>
                        <li><a href="https://arunp77.github.io/OLCI.html" target="_blank">Understanding how OLCI data is processed</a></li>
                        <li><a href="https://www.nesdis.noaa.gov/news/transforming-energy-imagery-how-satellite-data-becomes-stunning-views-of-earth" target="_blank">Transforming Energy into Imagery: How Satellite Data Becomes Stunning Views of Earth</a></li>
                    </ul>  
                </section>             
            </div>
            <a href="project_sst_1.html" class="clickable-box">Go to Content</a>
        </div>
    </section><!-- End Portfolio Details Section -->
</main><!-- End #main -->

<!-- ======= Footer ======= -->
<footer id="footer">
  <div class="container">
    <div class="copyright">
      &copy; Copyright <strong><span>Arun</span></strong>
    </div>
  </div>
</footer><!-- End  Footer -->

<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

<!-- Vendor JS Files -->
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/typed.js/typed.umd.js"></script>
<script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>

<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    hljs.initHighlightingOnLoad();
  });
</script>

</body>

</html>