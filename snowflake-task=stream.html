<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Portfolio Details</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/Favicon-1.png" rel="icon">
  <link href="assets/img/Favicon-1.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <!-- Creating a python code section-->
  <link rel="stylesheet" href="assets/css/prism.css">
  <script src="assets/js/prism.js"></script>


  <!-- To set the icon, visit https://fontawesome.com/account-->
  <script src="https://kit.fontawesome.com/5d25c1efd3.js" crossorigin="anonymous"></script>
  <!-- end of icon-->

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha384-oGqqFhf3ELCpQk69FVb6jGrwPOTR5SO5FeECBbCFgrFJzVpXJFLHc06dL/iPzCBJe" crossorigin="anonymous">


  <!-- =======================================================
  * Template Name: iPortfolio
  * Updated: Sep 18 2023 with Bootstrap v5.3.2
  * Template URL: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Mobile nav toggle button ======= -->
  <i class="bi bi-list mobile-nav-toggle d-xl-none"></i>

  <!-- ======= Header ======= -->
  <header id="header">
    <div class="d-flex flex-column">

      <div class="profile">
        <img src="assets/img/myphoto.jpeg" alt="" class="img-fluid rounded-circle">
        <h1 class="text-light"><a href="index.html">Arun</a></h1>
        <div class="social-links mt-3 text-center">
          <a href="https://www.linkedin.com/in/arunp77/" class="linkedin"><i class="bx bxl-linkedin"></i></a>
          <a href="https://github.com/arunp77" class="github"><i class="bx bxl-github"></i></a>
          <a href="https://twitter.com/arunp77_" class="twitter"><i class="bx bxl-twitter"></i></a>
          <a href="https://www.instagram.com/arunp77/" class="instagram"><i class="bx bxl-instagram"></i></a>
          <a href="https://medium.com/@arunp77" class="medium"><i class="bx bxl-medium"></i></a>
        </div>
      </div>

      <nav id="navbar" class="nav-menu navbar">
        <ul>
          <li><a href="index.html#hero" class="nav-link scrollto active"><i class="bx bx-home"></i> <span>Home</span></a></li>
          <li><a href="index.html#about" class="nav-link scrollto"><i class="bx bx-user"></i> <span>About</span></a></li>
          <li><a href="index.html#skills-and-tools" class="nav-link scrollto"><i class="bx bx-wrench"></i> <span>Skills and Tools</span></a></li>
          <li><a href="index.html#resume" class="nav-link scrollto"><i class="bx bx-file-blank"></i> <span>Resume</span></a></li>
          <li><a href="index.html#portfolio" class="nav-link scrollto"><i class="bx bx-book-content"></i> <span>Portfolio</span></a></li>
          <li><a href="index.html#services" class="nav-link scrollto"><i class="bx bx-server"></i> <span>Services</span></a></li>
          <li><a href="index.html#professionalcourses" class="nav-link scrollto"><i class="bx bx-book-alt"></i> <span>Professional Certification</span></a></li>
          <li><a href="index.html#publications" class="nav-link scrollto"><i class="bx bx-news"></i> <span>Publications</span></a></li>
          <li><a href="index.html#extra-curricular" class="nav-link scrollto"><i class="bx bx-rocket"></i> <span>Extra-Curricular Activities</span></a></li>
          <li><a href="index.html#contact" class="nav-link scrollto"><i class="bx bx-envelope"></i> <span>Contact</span></a></li>
        </ul>
      </nav><!-- .nav-menu -->
    </div>
  </header><!-- End Header -->

<main id="main">

    <!-- ======= Breadcrumbs ======= -->
    <section id="breadcrumbs" class="breadcrumbs">
      <div class="container">

        <div class="d-flex justify-content-between align-items-center">
          <h2>Portfolio Details</h2>
          <ol>
            <li><a href="portfolio-details-8.html" class="clickable-box">Go to Project page <i class="fas fa-arrow-right"></i></a></li>
            <li><a href="index.html#portfolio" class="clickable-box">Go to portfolio</a></li>
          </ol>
        </div>

      </div>
    </section><!-- End Breadcrumbs -->

    <div class="right-side-list">
      <ul>
          <li><a href="amazon-s3.html"><i class="fas fa-cloud"></i> Amazon S3</a></li>
          <li><a href="ec2-confi.html"><i class="fas fa-server"></i> EC2</a></li>
          <li><a href="Docker-Container.html"><i class="fas fa-docker"></i> Docker</a></li>
          <li><a href="Jupyter-nifi.html"><i class="fas fa-code"></i> Jupyter-nifi</a></li>
          <li><a href="snowflake-task=stream.html"><i class="fas fa-snowflake"></i> Snowflake</a></li>
          <li><a href="scd.html"><i class="fas fa-archive"></i> SCD</a></li>
          <!-- Add more subsections as needed -->
      </ul>
  </div>
  

    <!-- ======= Portfolio Details Section ======= -->
    <section id="portfolio-details" class="portfolio-details">
        <div class="container">
            <div class="row gy-4">
                <h1>Automating Real-Time Data Ingestion and Analysis with Snowflake</h1>
                    <div class="col-lg-8">
                        <div class="portfolio-details-slider swiper">
                            <div class="swiper-wrapper align-items-center">
                    
                                <div class="swiper-slide">
                                    <img src="assets/img/portfolio/snowflake_logo.webp" class="img-fluid" alt="Image Description" style="width: 300px; height: 300px;">
                                </div>
                    
                                <div class="swiper-slide">
                                    <img src="assets/img/portfolio/snowflake-workspace.png" alt="Image Description" style="width: 700px; height: 300px;">
                                </div>
                    
                                <div class="swiper-slide">
                                    <img src="assets/img/portfolio/Snowflake-AWS-integration.png" alt="Image Description" style="width: 550px; height: 200px;">
                                </div>
                            </div>
                            <div class="swiper-pagination"></div>
                        </div>
                    </div>

                    <p><a href="https://docs.snowflake.com/en/user-guide/setup" target="_blank">Snowflake</a> is a cloud-based data warehousing platform that allows you to store, 
                        analyze, and process large amounts of data. It provides various features to enable real-time data streaming and processing. In my project, 
                        I have utilized Snowflake to load the generated data from your JupyterLab environment into Snowflake databases.</p>

                    <h3>Setting Up Snowflake for Real-Time Data Loading</h3>
                    <p>We need to following steps, to setup the snowflake for real-time data loading. To look at the steps, you can look at following 
                        <a href="https://quickstarts.snowflake.com/guide/getting_started_with_streams_and_tasks/index.html#0" target="_blank">snowflake quickstart.</a></p>
                    <ul style="list-style-type: disc; margin-left: 30px;">
                        <li><strong>Step 1: Snowflake Account: </strong>To get started with Snowflake, you need to have a 
                            <a href="https://www.snowflake.com/login/" target="_blank">Snowflake account</a>. If you don't have one, 
                            sign up for Snowflake and set up your account.</li>
                            <ul style="list-style-type: circle;">
                                <li>To get started with Snowflake, you need to have a Snowflake account. If you don't have one, sign up for Snowflake and set up your account.</li>
                                <li>Your journey into real-time data processing with Snowflake begins by creating or accessing your Snowflake account. Snowflake offers a cloud-based 
                                    data warehousing platform that allows you to store, manage, and analyze data with scalability and performance in mind. If you're new to Snowflake, 
                                    you can sign up for an account to gain access to the platform.</li>
                            </ul>
                        <li><strong>Step 2: Database and Schema: </strong>In Snowflake, you typically work within a specific database and schema. Ensure you have the appropriate database and schema created to receive the 
                            incoming data.</li>
                            <p>In Snowflake, data is organized within databases and schemas. A database acts as a logical container for your data, while a schema is a logical 
                                container within a database. You should ensure that you have the appropriate database and schema created to receive the incoming real-time data. 
                                This step is crucial for structuring your data in a way that aligns with your analysis requirements.</p>
                            <pre><code class="language-sql">
                                create database if not exists scd_demo;
                                use database scd_demo;
                                create schema if not exists scd2;
                                use schema scd2;
                                show tables;

                                create or replace table customer (
                                    customer_id number,
                                    first_name varchar,
                                    last_name varchar,
                                    email varchar,
                                    street varchar,
                                    city varchar,
                                    state varchar,
                                    country varchar,
                                    update_timestamp timestamp_ntz default current_timestamp());

                                create or replace table customer_history (
                                    customer_id number,
                                    first_name varchar,
                                    last_name varchar,
                                    email varchar,
                                    street varchar,
                                    city varchar,
                                    state varchar,
                                    country varchar,
                                    start_time timestamp_ntz default current_timestamp(),
                                    end_time timestamp_ntz default current_timestamp(),
                                    is_current boolean
                                    );
                                    
                                create or replace table customer_raw (
                                    customer_id number,
                                    first_name varchar,
                                    last_name varchar,
                                    email varchar,
                                    street varchar,
                                    city varchar,
                                    state varchar,
                                    country varchar);
                                    
                                create or replace stream customer_table_changes on table customer;
                            </code></pre>
                            
                        <li><strong>Step 3: Snowpipe: </strong>Snowpipe is a feature in Snowflake that automates the ingestion of data from external stages (like S3 buckets). 
                            You'll configure Snowpipe to monitor a specific S3 bucket for new data files.</li>
                            <p>Next is to set connection between the s3 bucket and the snowflake:</p>
                            <pre><code class="language-sql">
                                // Creating external stage (create your own bucket)
                                CREATE OR REPLACE STAGE SCD_DEMO.SCD2.customer_ext_stage
                                    url='s3://[bucket-name]/path-to-data-folder'
                                    credentials=(aws_key_id='provide_key' aws_secret_key='provide_secret_key');
                                

                                CREATE OR REPLACE FILE FORMAT SCD_DEMO.SCD2.CSV
                                TYPE = CSV,
                                FIELD_DELIMITER = ","
                                SKIP_HEADER = 1;

                                SHOW STAGES;
                                LIST @customer_ext_stage;


                                CREATE OR REPLACE PIPE customer_s3_pipe
                                auto_ingest = true
                                AS
                                COPY INTO customer_raw
                                FROM @customer_ext_stage
                                FILE_FORMAT = CSV
                                ;

                                show pipes;
                                select SYSTEM$PIPE_STATUS('customer_s3_pipe');

                                SELECT count(*) FROM customer_raw limit 10;

                                TRUNCATE  customer_raw;
                            </code></pre>

                        <li><strong>Step 4: Snowflake Stream: </strong>A Snowflake stream is a changelog or transaction log that captures changes made to a table or set of tables. You will need to create a Snowflake 
                            stream for the table where you want to load real-time data.</li>
                            <p>A Snowflake stream is a vital component for tracking changes in a table or a set of tables. It acts as a changelog or transaction log that records 
                                all data modifications, such as inserts, updates, and deletes. To enable real-time data loading, you'll create a Snowflake stream for the table 
                                where you want to continuously ingest and analyze data. This stream captures changes, ensuring that you have access to the latest data for analysis.</p>
                            <pre><code class="language-sql">
                                merge into customer c 
                                using customer_raw cr
                                on  c.customer_id = cr.customer_id
                                when matched and c.customer_id <> cr.customer_id or
                                                c.first_name  <> cr.first_name  or
                                                c.last_name   <> cr.last_name   or
                                                c.email       <> cr.email       or
                                                c.street      <> cr.street      or
                                                c.city        <> cr.city        or
                                                c.state       <> cr.state       or
                                                c.country     <> cr.country then update
                                    set c.customer_id = cr.customer_id
                                        ,c.first_name  = cr.first_name 
                                        ,c.last_name   = cr.last_name  
                                        ,c.email       = cr.email      
                                        ,c.street      = cr.street     
                                        ,c.city        = cr.city       
                                        ,c.state       = cr.state      
                                        ,c.country     = cr.country  
                                        ,update_timestamp = current_timestamp()
                                when not matched then insert
                                        (c.customer_id,c.first_name,c.last_name,c.email,c.street,c.city,c.state,c.country)
                                    values (cr.customer_id,cr.first_name,cr.last_name,cr.email,cr.street,cr.city,cr.state,cr.country);
                                    


                                CREATE OR REPLACE PROCEDURE pdr_scd_demo()
                                returns string not null
                                language javascript
                                as
                                    $$
                                    var cmd = `
                                                merge into customer c 
                                                using customer_raw cr
                                                    on  c.customer_id = cr.customer_id
                                                when matched and c.customer_id <> cr.customer_id or
                                                                c.first_name  <> cr.first_name  or
                                                                c.last_name   <> cr.last_name   or
                                                                c.email       <> cr.email       or
                                                                c.street      <> cr.street      or
                                                                c.city        <> cr.city        or
                                                                c.state       <> cr.state       or
                                                                c.country     <> cr.country then update
                                                    set c.customer_id = cr.customer_id
                                                        ,c.first_name  = cr.first_name 
                                                        ,c.last_name   = cr.last_name  
                                                        ,c.email       = cr.email      
                                                        ,c.street      = cr.street     
                                                        ,c.city        = cr.city       
                                                        ,c.state       = cr.state      
                                                        ,c.country     = cr.country  
                                                        ,update_timestamp = current_timestamp()
                                                when not matched then insert
                                                            (c.customer_id,c.first_name,c.last_name,c.email,c.street,c.city,c.state,c.country)
                                                    values (cr.customer_id,cr.first_name,cr.last_name,cr.email,cr.street,cr.city,cr.state,cr.country);
                                    `
                                    var cmd1 = "truncate table SCD_DEMO.SCD2.customer_raw;"
                                    var sql = snowflake.createStatement({sqlText: cmd});
                                    var sql1 = snowflake.createStatement({sqlText: cmd1});
                                    var result = sql.execute();
                                    var result1 = sql1.execute();
                                    return cmd+'\n'+cmd1;
                                    $$;
                                call pdr_scd_demo();


                                --Set up TASKADMIN role
                                use role securityadmin;
                                create or replace role taskadmin;
                                -- Set the active role to ACCOUNTADMIN before granting the EXECUTE TASK privilege to TASKADMIN
                                use role accountadmin;
                                grant execute task on account to role taskadmin;

                                -- Set the active role to SECURITYADMIN to show that this role can grant a role to another role 
                                use role securityadmin;
                                grant role taskadmin to role sysadmin;

                                create or replace task tsk_scd_raw warehouse = COMPUTE_WH schedule = '1 minute'
                                ERROR_ON_NONDETERMINISTIC_MERGE=FALSE
                                as
                                call pdr_scd_demo();
                                show tasks;
                                alter task tsk_scd_raw suspend;--resume --suspend
                                show tasks;

                                select timestampdiff(second, current_timestamp, scheduled_time) as next_run, scheduled_time, current_timestamp, name, state 
                                from table(information_schema.task_history()) where state = 'SCHEDULED' order by completed_time desc;


                                select * from customer where customer_id=0;
                            </code></pre>

                        <li><strong>Step 5: Snowflake Task: </strong>A Snowflake task is used to execute a series of SQL statements, including COPY INTO statements, when certain conditions are met. You will create a 
                            Snowflake task that uses the Snowpipe to load data from the S3 bucket into Snowflake whenever new data arrives.</li>
                        <li><strong>Step 6: S3 Integration: </strong>Make sure your Snowflake account is integrated with your S3 bucket. This integration allows Snowflake to access data stored in your S3 bucket.</li>
                    </ul>
             
            </div>
            <a href="portfolio-details-8.html" class="clickable-box">Go back</a>
        </div>
    </section><!-- End Portfolio Details Section -->
</main><!-- End #main -->

<!-- ======= Footer ======= -->
<footer id="footer">
  <div class="container">
    <div class="copyright">
      &copy; Copyright <strong><span>Arun</span></strong>
    </div>
    <div class="credits">
      <!-- All the links in the footer should remain intact. -->
      <!-- You can delete the links only if you purchased the pro version. -->
      <!-- Licensing information: https://bootstrapmade.com/license/ -->
      <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/ -->
      Designed by <a href="https://arunp77.github.io/Vision-Analytics/" target="_blank">Vision ANalytica</a>
    </div>
  </div>
</footer><!-- End  Footer -->

<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

<!-- Vendor JS Files -->
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/typed.js/typed.umd.js"></script>
<script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>

<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    hljs.initHighlightingOnLoad();
  });
</script>

</body>

</html>